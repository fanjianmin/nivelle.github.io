---
layout: post
title:  "事物学习"
date:   2017-06-05 00:06:05
categories: 技术
tags: 事物
excerpt: 事物
author: nivelle
---


* content
{:toc}


#### 事物

定义：以可控的方式对数据资源进行访问的一组操作。为了保证事物执行前后数据资源所承载的系统始终处于正确状态，事物持有四个特性来实现这个目的：

- 原子性：事物所包含的全部操作是一个不可分割的整体，这些操作要么全部提交成功，要么只要其中的一个失败，就全部失败。
- 一致性：事物所包含的操作不能违反数据资源的一致性检查，数据资源在事物执行前处于某个数据一致性状态，那么事物执行之后依然需要保持数据间的一致性状态。
- 隔离性：事物的隔离性主要规定了各个事物之间相互影响的程度，隔离性的概念主要主要面对数据资源的并发访问，并兼顾影响事物的一致性。当两个事物或者更多事物同时访问同一个数据资源的时候，不同的隔离级别决定了各个事物对该数据资源访问的不同行为。4种类型的隔离级别：

   -. Read Uncommitted:最低隔离级别。它最直接的效果就是 ，**一个事物可以读取另一个事物没有提交的更新结果**。Read Uncommitted是以较低的隔离度来寻求较高的性能，其本身面临以下问题：
   
     （1）脏读：如果一个事物对数据进行了更新，但事物还没提交，另一事物就可以看到该事物没有提交的更新结果。如果第一个事物回滚，那么第二个事物在此之前读到的数据就是一笔脏数据。

     （2）不可重复读：不可重复读指的是通一个事物在整个事物过程中对同一笔数据进行读取，每次读取的结果都不同。如果事物1在事物2的更新操作之前读过一次数据，在事物2的更新操作之后再读取同一笔数据一次，两次结果是不同的。
  
     （3）幻读：指的是同样一个查询在整个事物过程中多次执行后，查询所得的结果集是不一样的。幻读针对的是多笔记录。在Read Uncommitted隔离级别下，不管事物2的插入操作是否提交，事物1在插入操作之前和之后执行相同的查询，取得的结果集是不一样的。
 
  -. Read Committed：大部分数据库采取的默认隔离级别，他比Read Uncommitted隔离级别拥有更高级别的限定。一个事物的更新操作结果只有在该事物提交之后，另一个事物才能读到同一笔数据更新后的结果。所以它可以避免脏读问题。 
  -. Repeatable Read：它保证在事物的整个过程中，对同一笔数据的读取结果是相同的，不管其他事物是否同时在对同一笔数据进行更新，也不管其他事物对同一笔数据的更新提交与否。它能够避免脏读和不可重复读，但是无法避免幻读。
  -. Serializable:它是最严格的隔离级别。所有事物都一次执行，可以避免其他隔离级别遇到的所有问题，是最安全的隔离级别。但是我们通常会使用其他隔离级别加上相应的并发锁的机制来控制对数据的访问，这样能保证系统的性能损失不会太大，也能够在一定程度山保证数据一致性。
    ![image](http://7xpuj1.com1.z0.glb.clouddn.com/%E4%BA%8B%E7%89%A9.png) 

- 持久性：一旦整个事物操作成功提交，对数据所做的变更将被记载并不可逆转。


#### 事物中的概念

- Resource Manager
- Transaction Processing Monitor
- Transaction Manager
- Application
