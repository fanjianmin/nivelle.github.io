---
layout: post
title:  "Zookeper基础学习"
date:   2016-04-12 01:06:05
categories: 技术
tags: zk
excerpt: zk
---


* content
{:toc}

### 分布式架构

##### 集中式的特点

所谓的集中式系统就是指由一台或多台主计算机组成中心节点，数据集中存储于这个中心节点中，并且整个系统的所有业务单元都集中部署在这个中心节点上，系统的所有功能尤其集中处理。也就是说，在集中式系统中，每个终端或客户端机器仅仅负责数据的录入和输出，而数据的存储于控制处理完全交由主机来完成。

##### 分布式的特点

分布式系统是一个硬件或软件组件分布在不同的网络计算机上，彼此之间仅仅通过消息传递进行通信和协调的系统。

- 分布性：系统中多台计算机都会在空间上随意分布，同时，机器的分布情况也会随时变动。
- 对等性：分布式系统中的计算机没有主从之分，既没有控制整个系统的主机，也没有被控制的从机，组成分布式系统的所有计算机节点都是对等的。副本是分布式系统最常见的概念之一，指的是分布式系统和服务提供的一种冗余方式。
数据副本：在不同节点上持久化同一份数据，当某一个节点上存储的数据丢失时，可以从副本上读取到该数据，这是解决分布式系统数据丢失问题最为有效的手段
服务副本：指多个阶段提供同样的服务，每个节点都有能力接收来自外部的请求并进行相应的处理
- 并发性：在一个计算机网络中，程序运行过程中的并发操作时非常常见的行为。例如同一个分布式系统中的多个节点，可能会并发地操作一些共享的资源，注入数据库或分布式存储等。

- 缺乏全局时钟：一个典型的分布式系统是由一些列在空间上随意分布的多个进程组成的，具有明显的分布性，这些进程之间通过交换消息来进行互相通信。因此在分布式系统中，很难定义两个事件究竟谁先谁后，原因就是分布式系统缺乏一个全局的时钟序列控制。

#### 分布式环境的各种问题

- 通信异常：分布式系统需要在各个节点之间进行网络通信，因此每次网络通信都会伴随着网络不可用的风险，网络光纤、路由器或是DNS等硬件设备或是系统不可用都会导致最终分布式系统无法完成一次网络通信。同时，消息丢失和消息延迟的现象也无法避免。
- 网络分区：当网络由于发生异常情况，导致分布式系统中部分节点之间的网络延时不断增大，最终导致组成分布式系统的所有节点中，只有部分节点之间能够进行正常通信，而另一些节点则不能，我们将这个现象称为网络分区。

### 三态

成功、失败、超时

#### 超时：

1. 由于网络原因，该请求并没有被成功地发送到接收方，而是在发送过程就发生了消息丢失现象。
2. 该请求成功的被接收方接收后，并进行了处理，但是在将响应反馈给发送方的过程中，发生了消息丢失现象。


### 节点故障

指的是组成分布式系统的服务器节点出现宕机或“僵死”现象。

###  分布式事务

分布式事务是指事务的参与者、支持事物的服务器、资源服务器以及事务管理器分别位于分布式系统的不同节点之上。通常一个分布式事务中会涉及对多个数据源或业务系统的操作。

一个分布式事务可以看作是由多个分布式的操作序列组成的，通常可以把这一系列分布式的操作序列称为子事务。因此，分布式事务也可以被定义为一种嵌套型的事务，同时也就具有了ACID事务特性。但由于在分布式事务中，各个子事务的执行时分布式的。

####  CAP理论

CAP理论告诉我们，一个分布式系统不可能同时满足一致性、可用性和分区容错性。

- 一致性：指的是数据在多个副本之间是否能够保持一致的特性。在一致性的需求下，当一个系统在数据一致的状态下执行更新操作后，应该保证形态的数据任然处于一致的状态。
- 可用性：系统服务必须一直处于可用的状态，对于用户的每个操作请求总是能够在有限的时间内返回结果。
- 分区容错性：分布式系统在遇到任何网络分区故障的时候，任然需要能够保证对外提供满足一致性和可用性的服务，除非是整个网络环境都发生了故障。

网络分区是指在分布式系统中，不同的节点分布在不同的子网络（机房或异地网络等）中，由于一些特殊的原因导致这些子网络之间出现网络不连通的状况，但各个子网络的内部网络是正常的，从而导致整个系统的环境被切分成了若干个孤立的区域。需要注意的是，组成一个分布式系统的每个节点的加入与退出都可以看作是一个特殊的网络分区。

![image](http://7xpuj1.com1.z0.glb.clouddn.com/CAP%E7%90%86%E8%AE%BA.png)

#### BASE理论

BASE是对CAP中一致性和可用性权衡的结果，其来源于对大规模互联网系统分布式实践的总结，是基于CAP定理逐步演化而来的，其核心思想是即使无法做到强一致性，但每个应用都可以根据自身的业务特点，采用适当的方式来使胸到达最终一致性。
