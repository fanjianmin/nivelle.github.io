---
layout: post
title:  "mysql之高级特性"
date:   2017-05-05 00:06:05
categories: mysql
tags: mysql
excerpt: mysql高级特性
---


* content
{:toc}

### 分区表

**原理**：对用户来说，分区表是一个独立的逻辑表，但是底层由多个物理子表组成。实现分区的代码实际上是对一组底层表的句柄对象(Handler Object)的封装。对分区表的请求，都会通过句柄对象转化成对存储引擎的接口调用。所以分区对于SQL层来说是一个完全封装底层实现的黑盒子，对应用是透明的，但是从底层文件系统来看就很容易发现，每个分区表都有一个使用#分割命名的表文件。

MySql在创建表时使用PARTITION BY子句定义每个分区存放的数据。在执行查询的时候，优化器会根据分区定义过滤那些没有我们需要的分区，这样查询就无须扫描所有分区——只需要查找包含需要数据的分区就可以了。

#####  索引也是按照分区的子表定义的，而没有全局索引。

**目标**：主要是将数据按照一个较粗的粒度分在不同的表中。这样做可以将相关的数据存放在一起，另外，如果想一次批量删除整个分区的数据也会变得更方便。

####  应用场景

- 表非常大以致无法全部都放在内存中，或者只在表的最后部分有热点数据，其他均是历史数据。
- 分区表的数据更容易维护。例如想批量删除大量数据可以使用清除整个分区的方式。
- 分区表的数据可以分布在不同的物理设备上，从而高效地利用多个硬件设备。
- 使用分区表来避免某些特殊的瓶颈，例如InnoDB的单个索引的互斥访问。
- 如果需要，还可以备份和恢复独立的分区，这在非常大的数据集的场景小效果非常好。

####  限制

- 一个表最多只能有1024各分区
- 在MySQL 5.1 中，分区表达式必须是整数，或者是返回整数的表达式。在MySQL5.5中，某些场景中可以直接使用列来进行分区
- 如果分区字段中有主键或者唯一索引的列，那么所有的主键列和唯一索引列都必须包含进来。
- 分区表中无法使用外键
